<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Manage your Watch Later list on iStreamByWeb with sorting and filtering options"
    />
    <meta
      name="keywords"
      content="watch later, movies, series, streaming, entertainment"
    />
    <meta name="author" content="iStreamByWeb" />
    <title>iStreamByWeb - Watch Later</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <link rel="stylesheet" href="/css/watch_later.css" />
  </head>
  <body>
    <button class="hamburger" aria-label="Toggle sidebar" aria-expanded="false">
      <i class="fas fa-bars"></i>
    </button>

    <header class="header" aria-label="Site Header">
      <div class="logo"><i class="fas fa-clock"></i> iStreamByWeb</div>
      <div class="header-actions">
        <button class="theme-toggle tooltip" data-tooltip="Toggle Theme">
          <i class="fas fa-moon"></i>
        </button>
        <button class="help-button tooltip" data-tooltip="How to Use">
          <i class="fas fa-question-circle"></i>
        </button>
        <div class="user-profile">
          <i
            class="fas fa-user-circle tooltip"
            data-tooltip="Profile"
            aria-label="User Profile"
            aria-haspopup="true"
            aria-expanded="false"
          ></i>
          <div class="profile-dropdown" role="menu">
            <a href="/profile" role="menuitem">Profile</a>
            <a href="/settings" role="menuitem">Settings</a>
            <a href="/logout" role="menuitem">Logout</a>
          </div>
        </div>
      </div>
    </header>

    <nav class="sidebar" aria-label="Main Navigation">
      <div class="sidebar-item tooltip" data-tooltip="Home" style="--i: 1">
        <a href="home.html">
          <div class="sidebar-icon"><i class="fas fa-home"></i></div>
          <div class="sidebar-label">Home</div>
        </a>
      </div>
      <div class="sidebar-item tooltip" data-tooltip="Discover" style="--i: 2">
        <a href="discover.html">
          <div class="sidebar-icon"><i class="fas fa-search"></i></div>
          <div class="sidebar-label">Discover</div>
        </a>
      </div>
      <div
        class="sidebar-item active tooltip"
        data-tooltip="Watch Later"
        style="--i: 3"
      >
        <a href="watch_later.html" aria-current="page">
          <div class="sidebar-icon"><i class="fas fa-clock"></i></div>
          <div class="sidebar-label">Watch Later</div>
        </a>
      </div>
      <div class="sidebar-item tooltip" data-tooltip="Settings" style="--i: 4">
        <a href="settings.html">
          <div class="sidebar-icon"><i class="fas fa-cog"></i></div>
          <div class="sidebar-label">Settings</div>
        </a>
      </div>
    </nav>

    <main class="main" aria-label="Main Content Area">
      <div class="search-bar">
        <input
          type="text"
          class="search-input"
          placeholder="Search your Watch Later list..."
          id="search-input"
          aria-label="Search in Watch Later list"
        />
        <i class="fas fa-search" aria-hidden="true"></i>
      </div>

      <div class="filter-bar" role="toolbar">
        <div class="filter-container">
          <button
            class="filter-button tooltip"
            onclick="toggleDropdown(this)"
            data-tooltip="Sort Options"
            aria-haspopup="true"
            aria-expanded="false"
          >
            Sort By
          </button>
          <div class="dropdown-menu" role="menu">
            <button onclick="sortBy('title')" role="menuitem">Title</button>
            <button onclick="sortBy('addedDate')" role="menuitem">
              Date Added
            </button>
            <button onclick="sortBy('rating')" role="menuitem">
              Rating
            </button>
          </div>
        </div>
        <div class="filter-container">
          <button
            class="filter-button tooltip"
            id="filter-type-button"
            onclick="toggleDropdown(this)"
            data-tooltip="Filter Options"
            aria-haspopup="true"
            aria-expanded="false"
          >
            Filter: All
          </button>
          <div class="dropdown-menu" role="menu" id="filter-type-dropdown">
            <button onclick="filterBy('all', this)" data-filter-type="all" role="menuitem">
              All
            </button>
            <button onclick="filterBy('movie', this)" data-filter-type="movie" role="menuitem">
              Movies
            </button>
            <button onclick="filterBy('tv', this)" data-filter-type="tv" role="menuitem">
              Series
            </button>
          </div>
        </div>
      </div>

      <section
        class="watch-later-grid"
        id="watch-later-grid"
        aria-live="polite"
        aria-label="Watch Later Items"
      ></section>

      <div
        class="loading-spinner"
        id="loading-spinner-watch-later"
        style="
          display: none;
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 2rem;
          color: var(--primary-color, #007bff);
          z-index: 1010;
        "
      >
        <i class="fas fa-spinner fa-spin" aria-hidden="true"></i>
      </div>
    </main>

    <nav class="bottom-nav" aria-label="Mobile Bottom Navigation">
      <a
        href="home.html"
        class="nav-item tooltip"
        data-tooltip="Home"
        aria-label="Go to Home page"
      >
        <div class="nav-icon"><i class="fas fa-home"></i></div>
        <div>Home</div>
      </a>
      <a
        href="discover.html"
        class="nav-item tooltip"
        data-tooltip="Discover"
        aria-label="Go to Discover page"
      >
        <div class="nav-icon"><i class="fas fa-search"></i></div>
        <div>Discover</div>
      </a>
      <a
        href="watch_later.html"
        class="nav-item active tooltip"
        data-tooltip="Watch Later"
        aria-current="page"
        aria-label="Go to Watch Later page"
      >
        <div class="nav-icon"><i class="fas fa-clock"></i></div>
        <div>Watch Later</div>
      </a>
      <a
        href="settings.html"
        class="nav-item tooltip"
        data-tooltip="Settings"
        aria-label="Go to Settings page"
      >
        <div class="nav-icon"><i class="fas fa-cog"></i></div>
        <div>Settings</div>
      </a>
    </nav>

    <button class="back-to-top" onclick="scrollToTop()" aria-label="Back to top">
      <i class="fas fa-chevron-up"></i>
    </button>

    <dialog id="tutorial-modal" class="tutorial-modal modal" aria-label="How to use the Watch Later list">
      <div class="modal-content">
        <h2>Manage Your Watch Later List</h2>
        <p>How to use this page:</p>
        <ul>
          <li><strong>Search:</strong> Use the search bar to find items.</li>
          <li><strong>Sort:</strong> Organize by title, date, or rating.</li>
          <li><strong>Filter:</strong> Show only movies, series, or all items.</li>
          <li><strong>Actions:</strong> Click on card icons to play, view details, or remove.</li>
        </ul>
        <button onclick="closeTutorial()" aria-label="Close tutorial">Got it!</button>
      </div>
    </dialog>

    <dialog id="trailer-modal" class="trailer-modal modal" aria-label="Trailer Player">
      <div class="trailer-modal-content">
        <button class="close" onclick="closeTrailerModal()" aria-label="Close trailer">×</button>
        <iframe
          id="trailer-iframe"
          width="100%"
          height="450"
          src=""
          frameborder="0"
          allow="autoplay; fullscreen"
          allowfullscreen
          title="Trailer Video Player"
        ></iframe>
      </div>
    </dialog>

    <dialog id="details-modal" class="details-modal modal" aria-label="Movie or Series Details">
      <div class="details-modal-content">
        <h2 id="details-title" style="margin-bottom: 10px"></h2>
        <img
          id="details-poster"
          src=""
          alt="Poster"
          style="max-width: 150px; height: auto; display: block; margin: 0 auto 15px auto; border-radius: 4px;"
        />
        <div
          id="details-info-scrollable"
          style="max-height: 30vh; overflow-y: auto; padding-right: 10px; border-top: 1px solid #444; padding-top: 10px;"
        >
          <p style="margin-bottom: 8px"><strong>Overview:</strong> <span id="details-overview" style="font-size: 0.9rem"></span></p>
          <p style="margin-bottom: 5px"><strong>Rating:</strong> <span id="details-rating"></span></p>
          <p style="margin-bottom: 5px"><strong>Release Date:</strong> <span id="details-release"></span></p>
          <p style="margin-bottom: 5px"><strong>Director:</strong> <span id="details-director">N/A</span></p>
          <p><strong>Main Cast:</strong> <span id="details-cast">N/A</span></p>
        </div>
        <div style="margin-top: 20px; text-align: center">
          <button
            onclick="openTrailerModalFromDetails()"
            id="details-trailer-button"
            class="action-btn"
            style="display: none; margin-right: 10px"
          >
            Play Trailer
          </button>
          <button onclick="document.getElementById('details-modal').close()" class="action-btn">Close</button>
        </div>
      </div>
    </dialog>

    <footer class="footer">
      <p>© 2025 iStreamByWeb. All rights reserved.</p>
      <div class="social-links">
        <a href="#" class="tooltip" data-tooltip="Follow us on Twitter" aria-label="Follow us on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
        <a href="#" class="tooltip" data-tooltip="Join our Discord" aria-label="Join our Discord community">
          <i class="fab fa-discord"></i>
        </a>
        <a href="#" class="tooltip" data-tooltip="Follow us on Instagram" aria-label="Follow us on Instagram">
          <i class="fab fa-instagram"></i>
        </a>
      </div>
    </footer>

    <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
    <script src="/js/watch_later.js" defer></script>
  </body>
</html>
